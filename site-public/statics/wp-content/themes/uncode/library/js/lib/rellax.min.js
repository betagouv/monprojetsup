(function(root,factory){typeof define=="function"&&define.amd?define([],factory):typeof module=="object"&&module.exports?module.exports=factory():root.Rellax=factory()})(typeof window!="undefined"?window:global,function(){var Rellax=function(el,options){"use strict";function validateCustomBreakpoints(){if(self.options.breakpoints.length===3&&Array.isArray(self.options.breakpoints)){var isAscending=!0,isNumerical=!0,lastVal;self.options.breakpoints.forEach(function(i){typeof i!="number"&&(isNumerical=!1),lastVal!==null&&i<lastVal&&(isAscending=!1),lastVal=i});if(isAscending&&isNumerical)return}self.options.breakpoints=[576,768,1201],console.warn("Rellax: You must pass an array of 3 numbers in ascending order to the breakpoints option. Defaults reverted")}var self=Object.create(Rellax.prototype),posY=0,screenY=0,posX=0,screenX=0,blocks=[],pause=!0,loop=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(callback){return setTimeout(callback,1e3/60)},loopId=null,supportsPassive=!1;try{var opts=Object.defineProperty({},"passive",{get:function(){supportsPassive=!0}});window.addEventListener("testPassive",null,opts),window.removeEventListener("testPassive",null,opts)}catch(e){}var clearLoop=window.cancelAnimationFrame||window.mozCancelAnimationFrame||clearTimeout,transformProp=window.transformProp||function(){var testEl=document.createElement("div");if(testEl.style.transform===null){var vendors=["Webkit","Moz","ms"];for(var vendor in vendors)if(testEl.style[vendors[vendor]+"Transform"]!==undefined)return vendors[vendor]+"Transform"}return"transform"}();self.options={speed:-2,verticalSpeed:null,horizontalSpeed:null,breakpoints:[576,768,1201],center:!1,wrapper:null,relativeToWrapper:!1,round:!0,vertical:!0,horizontal:!1,verticalScrollAxis:"y",horizontalScrollAxis:"x",callback:function(){}},options&&Object.keys(options).forEach(function(key){self.options[key]=options[key]}),options&&options.breakpoints&&validateCustomBreakpoints(),el||(el=".rellax");var elements=typeof el=="string"?document.querySelectorAll(el):[el];if(elements.length>0){self.elems=elements;if(self.options.wrapper&&!self.options.wrapper.nodeType){var wrapper=document.querySelector(self.options.wrapper);if(!wrapper){console.warn("Rellax: The wrapper you're trying to use doesn't exist.");return}self.options.wrapper=wrapper}var currentBreakpoint,getCurrentBreakpoint=function(w){var bp=self.options.breakpoints;return w<bp[0]?"xs":w>=bp[0]&&w<bp[1]?"sm":w>=bp[1]&&w<bp[2]?"md":"lg"},cacheBlocks=function(){for(var i=0;i<self.elems.length;i++){var block=createBlock(self.elems[i]);blocks.push(block)}},init=function(){for(var i=0;i<blocks.length;i++)self.elems[i].style.cssText=blocks[i].style;blocks=[],screenY=window.innerHeight,screenX=window.innerWidth,currentBreakpoint=getCurrentBreakpoint(screenX),setPosition(),cacheBlocks(),animate(),pause&&(window.addEventListener("resize",init),pause=!1,update())},createBlock=function(el){var dataPercentage=el.getAttribute("data-rellax-percentage"),dataSpeed=el.getAttribute("data-rellax-speed"),dataXsSpeed=el.getAttribute("data-rellax-xs-speed"),dataMobileSpeed=el.getAttribute("data-rellax-mobile-speed"),dataTabletSpeed=el.getAttribute("data-rellax-tablet-speed"),dataDesktopSpeed=el.getAttribute("data-rellax-desktop-speed"),dataVerticalSpeed=el.getAttribute("data-rellax-vertical-speed"),dataHorizontalSpeed=el.getAttribute("data-rellax-horizontal-speed"),dataVericalScrollAxis=el.getAttribute("data-rellax-vertical-scroll-axis"),dataHorizontalScrollAxis=el.getAttribute("data-rellax-horizontal-scroll-axis"),dataZindex=el.getAttribute("data-rellax-zindex")||0,dataMin=el.getAttribute("data-rellax-min"),dataMax=el.getAttribute("data-rellax-max"),dataMinX=el.getAttribute("data-rellax-min-x"),dataMaxX=el.getAttribute("data-rellax-max-x"),dataMinY=el.getAttribute("data-rellax-min-y"),dataMaxY=el.getAttribute("data-rellax-max-y"),mapBreakpoints,breakpoints=!0;!dataXsSpeed&&!dataMobileSpeed&&!dataTabletSpeed&&!dataDesktopSpeed?breakpoints=!1:mapBreakpoints={xs:dataXsSpeed,sm:dataMobileSpeed,md:dataTabletSpeed,lg:dataDesktopSpeed};var wrapperPosY=self.options.wrapper?self.options.wrapper.scrollTop:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;if(self.options.relativeToWrapper){var scrollPosY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;wrapperPosY=scrollPosY-self.options.wrapper.offsetTop}var posY=self.options.vertical?dataPercentage||self.options.center?wrapperPosY:0:0,posX=self.options.horizontal?dataPercentage||self.options.center?self.options.wrapper?self.options.wrapper.scrollLeft:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft:0:0,blockTop=posY+el.getBoundingClientRect().top,blockHeight=el.clientHeight||el.offsetHeight||el.scrollHeight,blockLeft=posX+el.getBoundingClientRect().left,blockWidth=el.clientWidth||el.offsetWidth||el.scrollWidth,percentageY=dataPercentage?dataPercentage:(posY-blockTop+screenY)/(blockHeight+screenY),percentageX=dataPercentage?dataPercentage:(posX-blockLeft+screenX)/(blockWidth+screenX);self.options.center&&(percentageX=.5,percentageY=.5);var speed=breakpoints&&mapBreakpoints[currentBreakpoint]!==null?Number(mapBreakpoints[currentBreakpoint]):dataSpeed?dataSpeed:self.options.speed,verticalSpeed=dataVerticalSpeed?dataVerticalSpeed:self.options.verticalSpeed,horizontalSpeed=dataHorizontalSpeed?dataHorizontalSpeed:self.options.horizontalSpeed,verticalScrollAxis=dataVericalScrollAxis?dataVericalScrollAxis:self.options.verticalScrollAxis,horizontalScrollAxis=dataHorizontalScrollAxis?dataHorizontalScrollAxis:self.options.horizontalScrollAxis,bases=updatePosition(percentageX,percentageY,speed,verticalSpeed,horizontalSpeed),style=el.style.cssText,transform="",searchResult=/transform\s*:/i.exec(style);if(searchResult){var index=searchResult.index,trimmedStyle=style.slice(index),delimiter=trimmedStyle.indexOf(";");delimiter?transform=" "+trimmedStyle.slice(11,delimiter).replace(/\s/g,""):transform=" "+trimmedStyle.slice(11).replace(/\s/g,"")}return{baseX:bases.x,baseY:bases.y,top:blockTop,left:blockLeft,height:blockHeight,width:blockWidth,speed:speed,verticalSpeed:verticalSpeed,horizontalSpeed:horizontalSpeed,verticalScrollAxis:verticalScrollAxis,horizontalScrollAxis:horizontalScrollAxis,style:style,transform:transform,zindex:dataZindex,min:dataMin,max:dataMax,minX:dataMinX,maxX:dataMaxX,minY:dataMinY,maxY:dataMaxY}},setPosition=function(){var oldY=posY,oldX=posX;posY=self.options.wrapper?self.options.wrapper.scrollTop:(document.documentElement||document.body.parentNode||document.body).scrollTop||window.pageYOffset,posX=self.options.wrapper?self.options.wrapper.scrollLeft:(document.documentElement||document.body.parentNode||document.body).scrollLeft||window.pageXOffset;if(self.options.relativeToWrapper){var scrollPosY=(document.documentElement||document.body.parentNode||document.body).scrollTop||window.pageYOffset;posY=scrollPosY-self.options.wrapper.offsetTop}return oldY!=posY&&self.options.vertical?!0:oldX!=posX&&self.options.horizontal?!0:!1},updatePosition=function(percentageX,percentageY,speed,verticalSpeed,horizontalSpeed){var result={},valueX=(horizontalSpeed?horizontalSpeed:speed)*100*(1-percentageX),valueY=(verticalSpeed?verticalSpeed:speed)*100*(1-percentageY);return result.x=self.options.round?Math.round(valueX):Math.round(valueX*100)/100,result.y=self.options.round?Math.round(valueY):Math.round(valueY*100)/100,result},deferredUpdate=function(){window.removeEventListener("resize",deferredUpdate),window.removeEventListener("orientationchange",deferredUpdate),(self.options.wrapper?self.options.wrapper:window).removeEventListener("scroll",deferredUpdate),(self.options.wrapper?self.options.wrapper:document).removeEventListener("touchmove",deferredUpdate),loopId=loop(update)},update=function(){setPosition()&&pause===!1?(animate(),loopId=loop(update)):(loopId=null,window.addEventListener("resize",deferredUpdate),window.addEventListener("orientationchange",deferredUpdate),(self.options.wrapper?self.options.wrapper:window).addEventListener("scroll",deferredUpdate,supportsPassive?{passive:!0}:!1),(self.options.wrapper?self.options.wrapper:document).addEventListener("touchmove",deferredUpdate,supportsPassive?{passive:!0}:!1))},animate=function(){var positions;for(var i=0;i<self.elems.length;i++){var verticalScrollAxis=blocks[i].verticalScrollAxis.toLowerCase(),horizontalScrollAxis=blocks[i].horizontalScrollAxis.toLowerCase(),verticalScrollX=verticalScrollAxis.indexOf("x")!=-1?posY:0,verticalScrollY=verticalScrollAxis.indexOf("y")!=-1?posY:0,horizontalScrollX=horizontalScrollAxis.indexOf("x")!=-1?posX:0,horizontalScrollY=horizontalScrollAxis.indexOf("y")!=-1?posX:0,percentageY=(verticalScrollY+horizontalScrollY-blocks[i].top+screenY)/(blocks[i].height+screenY),percentageX=(verticalScrollX+horizontalScrollX-blocks[i].left+screenX)/(blocks[i].width+screenX);positions=updatePosition(percentageX,percentageY,blocks[i].speed,blocks[i].verticalSpeed,blocks[i].horizontalSpeed);var positionY=positions.y-blocks[i].baseY,positionX=positions.x-blocks[i].baseX;blocks[i].min!==null&&(self.options.vertical&&!self.options.horizontal&&(positionY=positionY<=blocks[i].min?blocks[i].min:positionY),self.options.horizontal&&!self.options.vertical&&(positionX=positionX<=blocks[i].min?blocks[i].min:positionX)),blocks[i].minY!=null&&(positionY=positionY<=blocks[i].minY?blocks[i].minY:positionY),blocks[i].minX!=null&&(positionX=positionX<=blocks[i].minX?blocks[i].minX:positionX),blocks[i].max!==null&&(self.options.vertical&&!self.options.horizontal&&(positionY=positionY>=blocks[i].max?blocks[i].max:positionY),self.options.horizontal&&!self.options.vertical&&(positionX=positionX>=blocks[i].max?blocks[i].max:positionX)),blocks[i].maxY!=null&&(positionY=positionY>=blocks[i].maxY?blocks[i].maxY:positionY),blocks[i].maxX!=null&&(positionX=positionX>=blocks[i].maxX?blocks[i].maxX:positionX);var zindex=blocks[i].zindex,translate="translate3d("+(self.options.horizontal?positionX:"0")+"px,"+(self.options.vertical?positionY:"0")+"px,"+zindex+"px) "+blocks[i].transform;self.elems[i].style[transformProp]=translate}self.options.callback(positions)};return self.destroy=function(){for(var i=0;i<self.elems.length;i++)self.elems[i].style.cssText=blocks[i].style;pause||(window.removeEventListener("resize",init),pause=!0),clearLoop(loopId),loopId=null},init(),self.refresh=init,self}console.warn("Rellax: The elements you're trying to select don't exist.");return};return Rellax})